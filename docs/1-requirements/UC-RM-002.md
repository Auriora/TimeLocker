# UC-RM-002: Edit / Remove Repository

| Field                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Use Case ID**              | UC-RM-002                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Name**                     | Edit / Remove Repository                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Primary Actors**           | Everyday User, Power User                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Stakeholders & Interests** | **User** – wants to update repository details (endpoint, credentials, etc.) or remove obsolete repositories without affecting running processes. <br> **System** – must safely persist configuration changes, ensure pending backup jobs are updated or halted, and maintain a complete audit trail.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Pre-conditions**           | 1. At least one repository has been previously registered (per [UC-RM-001](UC-RM-001.md)). <br> 2. The repository to be edited or removed is currently accessible (for edits) or is no longer required. <br> 3. The user has the necessary permissions to modify repository configurations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Post-conditions**          | * **Successful edit:** Updated repository configuration saved; any associated scheduled backups re-evaluated; audit log updated with an entry (`REPO_UPDATE`). <br> * **Successful removal:** Repository is removed from the configuration; scheduled backups using that repository are cancelled or reassigned; audit log updated with an entry (`REPO_DELETE`).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **Main Flow**                | 1. User navigates to the **Manage Repositories** section on the dashboard. <br> 2. System displays a list of registered repositories with options to **Edit** or **Delete**. <br> 3. For editing: <br>   a. User selects a repository and clicks **Edit**. <br>   b. System loads the existing repository configuration in a pre-populated form. <br>   c. User modifies the repository details (e.g. endpoint, credentials, and region settings). <br>   d. System performs validation (including region compliance and connection tests) and highlights any errors. <br>   e. User clicks **Save**, after which the system updates the configuration and logs a `REPO_UPDATE` event. <br> 4. For removal: <br>   a. User selects a repository and clicks **Delete**. <br>   b. System displays a confirmation dialog outlining potential impacts (such as cancellation of scheduled backups). <br>   c. User confirms deletion. <br>   d. System deletes the repository configuration, cancels or updates affected backup schedules, and logs a `REPO_DELETE` event. |
| **Alternative Flows**        | **AF-1: Edit Validation Failure** <br>   a. If the system detects invalid changes (e.g. an unreachable endpoint or region mismatch), it displays error messages and highlights the problematic fields, preventing saving. <br><br> **AF-2: Cancel Edit Operation** <br>   a. If the user cancels the edit, no changes are saved and the system returns to the repository list. <br><br> **AF-3: Deletion Aborted** <br>   a. If the user cancels the deletion confirmation, the repository remains unchanged.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Special Requirements**     | * Must validate new repository details (including region compliance) with a maximum latency of <= 50 ms ([NFR-SEC-12](3-4-6-Security-Compliance.md#nfrSec12)). <br> * Audit log must capture both the pre-edit and post-edit states (for traceability) ensuring compliance with [FR-MON-001](3-1-6-Monitoring-Reporting.md#frMon001)/[006](3-1-6-Monitoring-Reporting.md#frMon006). <br> * For deletion, if the repository contains active or historic backups, the system should issue an additional confirmation prompt to prevent unintended data loss (per [FR-BK-002](3-1-2-Backup-Operations.md#frBk002) and [FR-MON-001](3-1-6-Monitoring-Reporting.md#frMon001)).                                                                                                                                                                                                                                                                                                                                                                                              |
| **Related FRs**              | [FR-RM-001](3-1-1-Repository-Management.md#frRm001) ... [FR-RM-005](3-1-1-Repository-Management.md#frRm005), [FR-SEC-002](3-1-3-Security.md#frSec002), [FR-MON-001](3-1-6-Monitoring-Reporting.md#frMon001)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Related NFRs**             | [NFR-SEC-12](3-4-6-Security-Compliance.md#nfrSec12), [NFR-PERF-02](3-4-1-Performance.md#nfrPerf02), plus relevant UI consistency and safety NFRs ([NFR-USE-01](3-4-3-Usability.md#nfrUse01))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

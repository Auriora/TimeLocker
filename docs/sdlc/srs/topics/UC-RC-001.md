# UC-RC-001: Restore Snapshot

| Field                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Use Case ID**              | UC-RC-001                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Name**                     | Restore Snapshot                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Primary Actors**           | Everyday User, Power User                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Stakeholders & Interests** | **User** – wants to quickly recover lost or corrupted files. <br> **System** – must ensure data integrity and avoid overwriting newer data unintentionally.                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Pre-conditions**           | 1. At least one snapshot exists in a reachable repository. <br> 2. User has write access to the chosen restore destination. <br> 3. Sufficient free space at destination.                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Post-conditions**          | • Successful: Selected files/folders restored to destination; audit log `RESTORE_SUCCESS` recorded. <br> • Failure: No data restored or partial restore flagged; error logged; user notified.                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Main Flow**                | 1. User navigates to **Snapshots** tab and selects a snapshot. <br> 2. System displays file browser of snapshot contents. <br> 3. User selects file(s)/folder(s) to restore and chooses destination path & overwrite policy. <br> 4. System checks available disk space and potential conflicts. <br> 5. System executes `restic restore` (or `restic mount` + copy) for selected items. <br> 6. System shows real-time progress (files, bytes, ETA). <br> 7. Upon completion, system verifies file hashes against snapshot metadata ([FR-RC-003](3-1-4-Recovery-Operations.md#frRc003)). <br> 8. System writes `RESTORE_SUCCESS` event to immutable audit log and updates dashboard history. |
| **Alternative Flows**        | **AF-1 Insufficient disk space** <br> a. Space check fails. <br> b. System prompts user to choose another destination or free space. <br><br> **AF-2 File conflict** <br> a. Destination contains newer version. <br> b. System offers options: Overwrite, Rename, Skip. <br><br> **AF-3 Network interruption** (remote repo) <br> a. Connection drops during restore. <br> b. System retries up to *n* times; if still failing, marks restore **Failed**. <br><br> **AF-4 User cancels restore** <br> a. User clicks **Cancel**. <br> b. System stops operation, cleans up partial files, logs `RESTORE_CANCELLED`.                                                      |
| **Special Requirements**     | • Progress updates ≤ 1 s latency ([NFR-PERF-02](3-4-1-Performance.md#nfrPerf02)). <br> • Hash verification mandatory unless user opts out ([FR-RC-003](3-1-4-Recovery-Operations.md#frRc003)). <br> • Restore throughput ≥ 60 MB/s on local repo ([NFR-PERF-03](3-4-1-Performance.md#nfrPerf03)). <br> • UI must provide clear conflict-resolution dialog ([NFR-USE-03](3-4-3-Usability.md#nfrUse03)).                                                                                                                                                                                                                                                                                                                                                                   |
| **Related FRs**              | [FR-RC-001](3-1-4-Recovery-Operations.md#frRc001), [FR-RC-002](3-1-4-Recovery-Operations.md#frRc002), [FR-RC-003](3-1-4-Recovery-Operations.md#frRc003), [FR-MON-001](3-1-6-Monitoring-Reporting.md#frMon001), [FR-MON-003](3-1-6-Monitoring-Reporting.md#frMon003)                                                                                                                                                                                                                                                                                                                                                     |
| **Related NFRs**             | [NFR-PERF-02](3-4-1-Performance.md#nfrPerf02)/[03](3-4-1-Performance.md#nfrPerf03), [NFR-REL-03](3-4-2-Reliability-Stability.md#nfrRel03), [NFR-USE-03](3-4-3-Usability.md#nfrUse03), [NFR-AUD-01](3-4-1-Performance.md#nfrAud01)/[02](3-4-1-Performance.md#nfrAud02)                                                                                                                                                                                                                                                                                                                                                       |
